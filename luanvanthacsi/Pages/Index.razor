@page "/"
@page "/overview"
@using luanvanthacsi.Data.Entities;
<PageHeader Class="site-page-header" Title="Tổng quan">
    <PageHeaderExtra>
        <Breadcrumb>
            <BreadcrumbItem><Icon Type="home"></Icon></BreadcrumbItem>
            <BreadcrumbItem>Trang chủ</BreadcrumbItem>
        </Breadcrumb>
    </PageHeaderExtra>
</PageHeader>
<Row Gutter="24">
    <AntDesign.Col Span="16">
        <Row Gutter="10">
            <GridCol Style="width:25%;">
                <div @onclick="OpenScientists">
                    <Card Style="background-color: #ff5370" Class="image-button">
                        <CardGrid Class="card-grid" Hoverable="true">
                            <div style="margin-top: -12px;">
                                <Icon Type="clock-circle" Theme="outline" Width="32px" Height="32px" /><br />
                                <b>Quản lý nhà khoa học</b>
                            </div>
                        </CardGrid>
                    </Card>
                </div>
            </GridCol>
            <GridCol Style="width:25%;">
                <div @onclick="OpenStudentList">
                    <Card Style="background-color: #4099ff" Class="image-button">
                        <CardGrid Class="card-grid" Hoverable="true">
                            <div style="margin-top: -12px;">
                                <Icon Type="calendar" Theme="outline" Width="32px" Height="32px" /><br />
                                <b>Quản lý học viên</b>
                            </div>
                        </CardGrid>
                    </Card>
                </div>
            </GridCol>
            <GridCol Style="width:25%;">
                <div @onclick="onpenThesisDefenses">
                    <Card Style="background-color: #2ed8b6" Class="image-button">
                        <CardGrid Class="card-grid" Hoverable="true">
                            <div style="margin-top: -12px;">
                                <Icon Type="swap" Theme="outline" Width="32px" Height="32px" /><br />
                                <b>Mở đợt bảo vệ</b>
                            </div>
                        </CardGrid>
                    </Card>
                </div>
            </GridCol>
            <GridCol Style="width:25%;">
                <div @onclick="OpenEvaluationBoards">
                    <Card Style="background-color: #ffb64d" Class="image-button">
                        <CardGrid Class="card-grid" Hoverable="true">
                            <div style="margin-top: -12px;">
                                <Icon Type="database" Theme="outline" Width="32px" Height="32px" /><br />
                                <b>Hội đồng đánh giá</b>
                            </div>
                        </CardGrid>
                    </Card>
                </div>
            </GridCol>
        </Row>
    </AntDesign.Col>
</Row>
<Row Style="margin-top: 16px">
    <AntDesign.Col Span="12" Style="padding-right: 5px">
        <div class="shadow_css background-white" style="padding-bottom: 10px">
            <Row Justify="space-between" Style="padding-top: 8px">
                <Title Level="4" Style="margin-left: 24px">Thống kê nhà khoa học</Title>
                <Space Size="@("small")">
                    <SpaceItem>
                        <Button Type="@ButtonType.Text" Icon="@IconType.Fill.Setting" OnClick="@(()=>{ _visible = true; })"></Button>
                    </SpaceItem>
                </Space>
            </Row>
            @if (id == null)
            {
                <span style="padding-left: 24px; font-weight: 500">Tổng quát</span>
            }
            else
            {
                var name = scientistList.Where(x => x.Id == id).Select(x => x.Name).FirstOrDefault();
                <span style="padding-left: 24px; font-weight: 500">@name</span>
            }
            @if (DataStatisticalScient?.Any() == true)
            {
                <AntDesign.Charts.Pie @ref="Chart1" Data="DataStatisticalScient" Config="config1" />
            }
        </div>
    </AntDesign.Col>
    <AntDesign.Col Span="12" Style="padding-right: 5px">
        <div class="shadow_css background-white" style="padding-bottom: 10px">
            <Row Justify="space-between" Style="padding-top: 8px">
                <Title Level="4" Style="margin-left: 24px">Thống kê học viên</Title>
                <Space Size="@("small")">
                    <SpaceItem>
                        <Button Type="@ButtonType.Text" Icon="@IconType.Fill.Setting"></Button>
                    </SpaceItem>
                </Space>
            </Row>
            <span style="padding-left: 24px; font-weight: 400">Tổng quát</span>
            @if (DataStatisticalStudent?.Any() == true)
            {
                <AntDesign.Charts.Column Data="data2" Config="config2" />
            }
        </div>
    </AntDesign.Col>
</Row>
<Modal Title="@title"
       Visible="@_visible"
       OnOk="@HandleOk"
       OnCancel="@HandleCancel">
    <Select TItem="Scientist" TItemValue="string"
            DataSource="scientistList" AllowClear
            EnableSearch @bind-Value="id"
            ValueName="@nameof(Scientist.Id)"
            LabelName="@nameof(Scientist.Name)"
            Placeholder="Chọn nhà khoa học"></Select>
</Modal>
@code {
    string id;
    string title = "Tham số biểu đồ hội đồng đánh giá";
    bool _visible = false;

    private async Task HandleOk(MouseEventArgs e)
    {
        _visible = false;
        await LoadAsync();
    }

    private void HandleCancel(MouseEventArgs e)
    {
        Console.WriteLine(e);
        _visible = false;
    }
}